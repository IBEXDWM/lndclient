version: "2"
run:
  go: "1.24"
linters:
  default: all
  disable:
    # Global variables are used in many places throughout the code base.
    - gochecknoglobals

    # We want to allow short variable names.
    - varnamelen

    # We want to allow TODOs.
    - godox

    # We have long functions, especially in tests. Moving or renaming those would
    # trigger funlen problems that we may not want to solve at that time.
    - funlen

    # Disable for now as we haven't yet tuned the sensitivity to our codebase
    # yet. Enabling by default for example, would also force new contributors to
    # potentially extensively refactor code, when they want to smaller change to
    # land.
    - gocyclo
    - gocognit
    - cyclop

    # Instances of table driven tests that don't pre-allocate shouldn't trigger
    # the linter.
    - prealloc

    # Init functions are used by loggers throughout the codebase.
    - gochecknoinits

    # Causes stack overflow, see https://github.com/polyfloyd/go-errorlint/issues/19.
    - errorlint

    # Don't forbid an empty line after function signature. We add it in multi-line case.
    - wsl_v5

    # Don't forbid "if err := ...; err != nil" checks.
    - noinlineerr

    # Don't demand any particular functions order.
    - funcorder

    # New linters that need a code adjustment first.
    - containedctx
    - contextcheck
    - depguard
    - dogsled
    - err113
    - errname
    - exhaustive
    - exhaustruct
    - forcetypeassert
    - gomoddirectives
    - importas
    - inamedparam
    - interfacebloat
    - ireturn
    - maintidx
    - mnd
    - nestif
    - nilerr
    - nilnil
    - nlreturn
    - noctx
    - nolintlint
    - paralleltest
    - perfsprint
    - protogetter
    - testpackage
    - thelper
    - tparallel
    - wrapcheck
    - wsl
  settings:
    gosec:
      excludes:
        - G402 # Look for bad TLS connection settings.
        - G306 # Poor file permissions used when writing to a new file.
        - G115 # Integer overflow conversion.
    lll:
      line-length: 80
    revive:
      rules:
        - name: exported # To enforce conventions around exported comments.
    staticcheck:
      checks:
        - -SA1019
    tagliatelle:
      case:
        rules:
          json: snake
    whitespace:
      multi-if: true
      multi-func: true
  exclusions:
    generated: lax
    presets:
      - common-false-positives
      - legacy
      - std-error-handling
    paths:
      - third_party$
      - builtin$
      - examples$
formatters:
  enable:
    - gofmt
    - goimports
  settings:
    gofmt:
      # simplify code: gofmt with `-s` option, true by default
      simplify: true
  exclusions:
    generated: lax
    paths:
      - third_party$
      - builtin$
      - examples$
